<form class="{{cssClass}} flexcol" autocomplete="off">
  <div class="item-sheet-content">
    <header class="sheet-header">
      <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}" height="64" width="64"/>
      <div class="header-fields">
        <h1 class="charname">
          <input name="name" type="text" value="{{item.name}}" placeholder="{{localize 'ZWOLF.ItemName'}}"/>
        </h1>
        <div class="item-subtitle">{{localize 'ZWOLF.ItemTypeEquipment'}}</div>
      </div>
    </header>

    <nav class="sheet-tabs tabs" data-group="primary">
      <a class="item" data-tab="basics">{{localize 'ZWOLF.Basics'}}</a>
      <a class="item" data-tab="sideeffects">{{localize 'ZWOLF.SideEffects'}}</a>
      <a class="item" data-tab="abilities">{{localize 'ZWOLF.GrantedAbilities'}}</a>
    </nav>

    <section class="sheet-body">
      <div class="tab" data-group="primary" data-tab="basics">
        <div class="form-group">
          <label>{{localize 'ZWOLF.Tags'}}</label>
          <input type="text" name="system.tags" value="{{join system.tags}}" placeholder="{{localize 'ZWOLF.TagsPlaceholder'}}"/>
          <p class="notes">{{localize 'ZWOLF.TagsHint'}}</p>
        </div>

        <!-- Physical Properties -->
        <div class="form-group">
          <div class="form-fields">
            <div class="form-group stacked">
              <label>{{localize 'ZWOLF.Quantity'}}</label>
              <select name="system.quantity">
                <option value="1" {{selected '1' system.quantity}}>1</option>
                <option value="many" {{selected 'many' system.quantity}}>{{localize 'ZWOLF.Many'}}</option>
              </select>
              <p class="notes">{{localize 'ZWOLF.QuantityHint'}}</p>
            </div>
            <div class="form-group stacked">
              <label>{{localize 'ZWOLF.Price'}}</label>
              <input type="number" name="system.price" value="{{system.price}}" data-dtype="Number" min="0" step="0.01"/>
              <p class="notes">{{localize 'ZWOLF.PriceHint'}}</p>
            </div>
            <div class="form-group stacked">
              <label>{{localize 'ZWOLF.Bulk'}}</label>
              <input type="number" name="system.bulk" value="{{system.bulk}}" data-dtype="Number" min="0" step="0.1"/>
              <p class="notes">{{localize 'ZWOLF.BulkHint'}}</p>
            </div>
            <div class="form-group stacked">
              <label>{{localize 'ZWOLF.Structure'}}</label>
              <input type="number" name="system.structure" value="{{system.structure}}" data-dtype="Number" min="0"/>
              <p class="notes">{{localize 'ZWOLF.StructureHint'}}</p>
            </div>
          </div>
        </div>

        <!-- Placement -->
        <div class="form-group">
          <label>{{localize 'ZWOLF.Placement'}}</label>
          <select name="system.placement" {{#unless item.actor}}disabled{{/unless}}>
            <option value="stowed" {{selected 'stowed' system.placement}}>{{localize 'ZWOLF.Stowed'}}</option>
            <option value="wielded" {{selected 'wielded' system.placement}}>{{localize 'ZWOLF.Wielded'}}</option>
            <option value="worn" {{selected 'worn' system.placement}}>{{localize 'ZWOLF.Worn'}}</option>
            <option value="readily-available" {{selected 'readily-available' system.placement}}>{{localize 'ZWOLF.ReadilyAvailable'}}</option>
            <option value="not-carried" {{selected 'not-carried' system.placement}}>{{localize 'ZWOLF.NotCarried'}}</option>
          </select>
          {{#if item.actor}}
            <p class="notes">{{localize 'ZWOLF.PlacementHint'}}</p>
          {{else}}
            <p class="notes">{{localize 'ZWOLF.PlacementDisabledHint'}}</p>
          {{/if}}
        </div>

        <!-- Required Placement for Effects -->
        <div class="form-group">
          <label>{{localize 'ZWOLF.RequiredPlacement'}}</label>
          <select name="system.requiredPlacement" data-dtype="String">
            <option value="" {{selected '' system.requiredPlacement}}>{{localize 'ZWOLF.NoRequirement'}}</option>
            <option value="wielded" {{selected 'wielded' system.requiredPlacement}}>{{localize 'ZWOLF.Wielded'}}</option>
            <option value="worn" {{selected 'worn' system.requiredPlacement}}>{{localize 'ZWOLF.Worn'}}</option>
            <option value="readily_available" {{selected 'readily_available' system.requiredPlacement}}>{{localize 'ZWOLF.ReadilyAvailable'}}</option>
            <option value="stowed" {{selected 'stowed' system.requiredPlacement}}>{{localize 'ZWOLF.Stowed'}}</option>
            <option value="not_carried" {{selected 'not_carried' system.requiredPlacement}}>{{localize 'ZWOLF.NotCarried'}}</option>
          </select>
          <p class="notes">{{localize 'ZWOLF.RequiredPlacementHint'}}</p>
          
          {{#if system.requiredPlacement}}
            <div class="placement-warning-info">
              <i class="fas fa-info-circle"></i>
              <strong>{{localize 'ZWOLF.PlacementRequirementActive'}}:</strong> 
              {{localize 'ZWOLF.PlacementRequirementActiveDescription' placement=system.requiredPlacement}}
            </div>
          {{/if}}
        </div>

        <!-- Description -->
        <div class="form-group">
          <label>{{localize 'ZWOLF.Description'}}</label>
          <div class="form-fields">
            {{#if editable}}
              {{editor system.description target="system.description" button=true editable=editable engine="prosemirror" collaborate=false}}
            {{else}}
              <div class="editor-content">{{{enrichedDescription}}}</div>
            {{/if}}
          </div>
        </div>
      </div>

      <!-- Side Effects Tab -->
      <div class="tab" data-group="primary" data-tab="sideeffects">
        <div class="side-effects">
          <div class="side-effects-header">
            <h3>{{localize 'ZWOLF.SideEffects'}}</h3>
            <p class="notes">{{localize 'ZWOLF.EquipmentSideEffectsHint'}}</p>
          </div>
          
          {{> side-effects-form 
              sideEffects=system.sideEffects 
              pathPrefix="system.sideEffects"
              showKnacksProvided=false
              showMaxBulkBoost=true}}
        </div>
      </div>

      <!-- Granted Abilities Tab -->
      <div class="tab" data-group="primary" data-tab="abilities">
        <div class="granted-abilities">
          <div class="abilities-header">
            <h3>{{localize 'ZWOLF.GrantedAbilities'}}</h3>
            <a class="ability-control" data-action="add-ability" title="{{localize 'ZWOLF.AddAbility'}}">
              <i class="fas fa-plus"></i>
            </a>
          </div>
          
          <div class="abilities-list">
            {{#each system.grantedAbilities as |ability index|}}
            {{> ability-item 
                ability=ability 
                index=index 
                nameTarget=(concat "system.grantedAbilities." index ".name")
                tagsTarget=(concat "system.grantedAbilities." index ".tags")
                typeTarget=(concat "system.grantedAbilities." index ".type")
                descriptionTarget=(concat "system.grantedAbilities." index ".description")
                deleteAction="delete-ability"
                editable=../editable}}
            {{/each}}
          </div>
        </div>
      </div>
    </section>
  </div>
</form>
